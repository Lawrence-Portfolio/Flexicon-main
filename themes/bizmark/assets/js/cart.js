!function(t){var e={};function a(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a(a.s=4)}({4:function(t,e,a){t.exports=a("L5fO")},L5fO:function(t,e,a){$((function(){"use strict";a("mOXF"),a("zKpq"),a("PxY9"),$('[data-toggle="popover"]').popover({trigger:"hover focus"})}))},PxY9:function(t,e,a){"use strict";function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}a.r(e),e.default=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.successModal="#success",this.init()}var e,a,r;return e=t,(a=[{key:"init",value:function(){null!=$(".cart-page")&&$(this.successModal).on("hide.bs.modal",(function(t){location.href="/"}))}}])&&n(e.prototype,a),r&&n(e,r),t}())},mOXF:function(t,e,a){"use strict";function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}a.r(e),e.default=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.openModal=".services-order",this.orderModal=".order-modal",this.orderForm=".order-form",this.successModal="#success",this.requisites="#requisites",this.design="#design",this.fileData=" .file-data",this.cartList=".cart-list",this.cartItemsCount=".cart-items-count",this.totalPrice=".total-price",this.totalPriceInput=".total-price-input",this.successMessageOrder=".success-message-order",this.initOrderForm()}var e,a,r;return e=t,(a=[{key:"initOrderForm",value:function(){var t=this;$(this.orderForm).submit((function(e){e.preventDefault(),$.oc.stripeLoadIndicator.show(),t.xhr&&t.xhr.abort();var a=t,n=$(e.currentTarget),r=n.find('button[type="submit"]');r.attr("disabled",!0),t.xhr=n.request("MakeOrder::onOrder",{files:!0,success:function(t){this.success(t),$(a.orderModal).modal("hide"),a.cartOrderDate(),$(a.successModal).modal("show"),n[0].reset(),window.location.href==window.location.origin+"/cart"&&a.clearCart()},error:function(){return $.oc.flashMsg({text:"Произошла ошибка при создании заказа. Попробуйте позднее, или обратитесь к нам по телефону указанному в контактах.",class:"error",interval:20})},complete:function(){$.oc.stripeLoadIndicator.hide(),r.attr("disabled",!1)}})}))}},{key:"cartOrderDate",value:function(){if(null!=$(this.successMessageOrder)[0]){var t=new Date,e=t.getDate(),a=t.getFullYear();$(this.successMessageOrder).find(".order-date").text("".concat(e,".").concat((n=t.getMonth(),++n<10?"0"+n:n),".").concat(a))}var n}},{key:"clearCart",value:function(){$(this.cartList).empty(),$(this.cartItemsCount).text("В корзине 0 товаров"),$(this.totalPrice).html('0,00 <i class="far fa-ruble-sign"></i>'),$(this.totalPriceInput).val(0),$(this.cartList).html('<div class="cart-empty">В корзине нет товаров</>'),localStorage.removeItem("cart")}}])&&n(e.prototype,a),r&&n(e,r),t}())},zKpq:function(t,e,a){"use strict";function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}a.r(e),e.default=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cartData=null,this.reducer=function(t,e){return t+e},this.cartList=".cart-list",this.cartItem=".cart-item",this.cartItemsCount=".cart-items-count",this.totalPrice=".total-price",this.totalPriceInput=".total-price-input",this.orderForm=".orderForm",this.successModal="#success",this.xhr=null,this.initCartPositions(),this.initDate()}var e,a,r;return e=t,(a=[{key:"initDate",value:function(){var t,e=new Date,a=e.getDate(),n=e.getFullYear();$('[name="orderDate"]').val("".concat(a,".").concat((t=e.getMonth(),++t<10?"0"+t:t),".").concat(n))}},{key:"initCartPositions",value:function(){var t=this;this.checkTime()&&localStorage.removeItem("cart"),this.cartData=JSON.parse(localStorage.getItem("cart")),null!=this.cartData?($(this.cartList).empty(),this.cartData.items.length>0?(this.cartData.items.forEach((function(e,a){$(t.cartList).append('\n                        <div class="cart-item">\n                            <picture>\n                                <img class="img-fluid item-icon" width="88px" height="88px" src="'.concat(e.boxIcon,'" alt="').concat(e.boxName,'">\n                            </picture>\n                            <div class="cart-info-wrap">\n                                <div class="cart-name">').concat(e.boxName,'</div>\n                                <div class="cart-info">\n                                    <div class="cart-settings">\n                                        <div><span>').concat(e.paperName,",</span> <span>Д: ").concat(e.boxSize.length," мм Ш: ").concat(e.boxSize.width," мм В: ").concat(e.boxSize.height," мм,</span></div>\n                                        <div>Принт: ").concat(e.printType,"</div>\n                                        <div>").concat(e.laminationType?e.laminationType:"",'</div>\n                                    </div>\n                                    <div class="cart-price">\n                                        <div class="cart-box-count">Тираж: ').concat(e.total,'</div>\n                                        <div class="cart-box-price">Цена: ').concat(e.price,' <i class="fal fa-ruble-sign"></i></div>\n                                    </div>\n                                </div>\n                            </div>\n                            <button class="remove-cart" type="button" remove-index="').concat(a,'"><i class="fal fa-times"></i></button>\n                            <input type="hidden" name="cart[').concat(a,'][name]" value="').concat(e.boxName,'">\n                            <input type="hidden" name="cart[').concat(a,'][paper_name]" value="').concat(e.paperName,'">\n                            <input type="hidden" name="cart[').concat(a,'][box_size_length]" value="').concat(e.boxSize.length,'">\n                            <input type="hidden" name="cart[').concat(a,'][box_size_width]" value="').concat(e.boxSize.width,'">\n                            <input type="hidden" name="cart[').concat(a,'][box_size_height]" value="').concat(e.boxSize.height,'">\n                            <input type="hidden" name="cart[').concat(a,'][print_type]" value="').concat(e.printType,'">\n                            <input type="hidden" name="cart[').concat(a,'][lamination_type]" value="').concat(e.laminationType,'">\n                            <input type="hidden" name="cart[').concat(a,'][quantity]" value="').concat(e.total,'">\n                            <input type="hidden" name="cart[').concat(a,'][price]" value="').concat(e.value.toFixed(2),'">\n                        </div> \n                    '))})),$(this.cartItemsCount).text("В корзине ".concat(this.cartData.items.length," ").concat(this.plur(this.cartData.items.length,"товар"))),$(this.totalPrice).html(this.cartData.totalPrice+' <i class="far fa-ruble-sign"></i>'),$(this.totalPriceInput).val(this.cartData.totalPriceValue.toFixed(2))):this.cartEmpty(),this.removeCart()):this.cartEmpty()}},{key:"cartEmpty",value:function(){$(this.cartItemsCount).text("В корзине 0 товаров"),$(this.cartList).html('<div class="cart-empty">В корзине нет товаров</>'),$(this.totalPrice).html('0,00 <i class="far fa-ruble-sign"></i>'),$(this.totalPriceInput).val("0.00")}},{key:"plur",value:function(t,e){return 1==t?e:t>=2&&t<=4?e+"a":t>=5?e+"ов":void 0}},{key:"removeCart",value:function(){var t=this;$(".remove-cart").on("click",(function(){var e=parseInt($(this).attr("remove-index"));t.cartData.items.splice(e,1),t.cartData.items.length>0?(t.cartData.totalPrice=t.moneyFormat(t.cartData.items.map((function(t){return t.value})).reduce(t.reducer)),t.cartData.totalPriceValue=t.cartData.items.map((function(t){return t.value})).reduce(t.reducer)):t.cartData.totalPrice=0,localStorage.setItem("cart",JSON.stringify(t.cartData)),t.initCartPositions()}))}},{key:"moneyFormat",value:function(t){return parseFloat(t).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1 ").replace(".",",")}},{key:"checkTime",value:function(){var t=parseInt(localStorage.getItem("old-date-time"));if(!isNaN(t)){var e=new Date;return t<new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getMinutes()).valueOf()}}}])&&n(e.prototype,a),r&&n(e,r),t}())}});
//# sourceMappingURL=cart.js.map